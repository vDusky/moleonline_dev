@use "sass:math";

@mixin user-select($select) {
    -webkit-user-select: $select;
       -moz-user-select: $select;
        -ms-user-select: $select; // IE10+
            user-select: $select;
  }

  @mixin non-selectable {
    -webkit-user-select: none; /* Chrome/Safari */
    -moz-user-select: none; /* Firefox */
    -ms-user-select: none; /* IE10+ */
    /* Rules below not implemented in browsers yet */
    -o-user-select: none;
    user-select: none;

    cursor: default;
}

.my-plugin {
    font-family: "Helvetica Neue", "Segoe UI", Helvetica, "Source Sans Pro", Arial, sans-serif;
    font-size: 14px;
    line-height: 1.42857143;
}

/*--------------------------------------*/
/*! normalize.css v3.0.3 | MIT License | github.com/necolas/normalize.css */

//
// 1. Set default font family to sans-serif.
// 2. Prevent iOS and IE text size adjust after device orientation change,
//    without disabling user zoom.
//
* {
    box-sizing: border-box; // 1
  }
  
    //
    // Address `[hidden]` styling not present in IE 8/9/10.
    // Hide the `template` element in IE 8/9/10/11, Safari, and Firefox < 22.
    //
    
    [hidden],
    template {
      display: none;
    }
    
    // Links
    // ==========================================================================
    
    //
    // Remove the gray background color from active links in IE 10.
    //
    
    a {
      background-color: transparent;
    }
    
    //
    // Improve readability of focused elements when they are also in an
    // active/hover state.
    //
    
    a:active,
    a:hover {
      outline: 0;
    }
    
    // Text-level semantics
    // ==========================================================================
    
    //
    // Address styling not present in IE 8/9/10/11, Safari, and Chrome.
    //
    
    abbr[title] {
      border-bottom: 1px dotted;
    }
    
    //
    // Address style set to `bolder` in Firefox 4+, Safari, and Chrome.
    //
    
    b,
    strong {
      font-weight: bold;
    }
    
    //
    // Address inconsistent and variable font size in all browsers.
    //
    
    small {
      font-size: 80%;
    }
    
    // Embedded content
    // ==========================================================================
    
    //
    // Remove border when inside `a` element in IE 8/9/10.
    //
    
    img {
      border: 0;
    }
    
    //
    // Correct overflow not hidden in IE 9/10/11.
    //
    
    svg:not(:root) {
      overflow: hidden;
    }
  
    // Forms
    // ==========================================================================
    
    //
    // Known limitation: by default, Chrome and Safari on OS X allow very limited
    // styling of `select`, unless a `border` property is set.
    //
    
    //
    // 1. Correct color not being inherited.
    //    Known issue: affects color of disabled elements.
    // 2. Correct font properties not being inherited.
    // 3. Address margins set differently in Firefox 4+, Safari, and Chrome.
    //
    
    button,
    input,
    optgroup,
    select,
    textarea {
      color: inherit; // 1
      font: inherit; // 2
      margin: 0; // 3
    }
    
    //
    // Address `overflow` set to `hidden` in IE 8/9/10/11.
    //
    
    button {
      overflow: visible;
    }
    
    //
    // Address inconsistent `text-transform` inheritance for `button` and `select`.
    // All other form control elements do not inherit `text-transform` values.
    // Correct `button` style inheritance in Firefox, IE 8/9/10/11, and Opera.
    // Correct `select` style inheritance in Firefox.
    //
    
    button,
    select {
      text-transform: none;
    }
    
    //
    // 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio`
    //    and `video` controls.
    // 2. Correct inability to style clickable `input` types in iOS.
    // 3. Improve usability and consistency of cursor style between image-type
    //    `input` and others.
    //
    
    button,
    html input[type="button"], // 1
    input[type="reset"],
    input[type="submit"] {
      -webkit-appearance: button; // 2
      cursor: pointer; // 3
    }
    
    //
    // Re-set default cursor for disabled elements.
    //
    
    button[disabled],
    html input[disabled] {
      cursor: default;
    }
    
    //
    // Remove inner padding and border in Firefox 4+.
    //
    
    button::-moz-focus-inner,
    input::-moz-focus-inner {
      border: 0;
      padding: 0;
    }
    
    //
    // Address Firefox 4+ setting `line-height` on `input` using `!important` in
    // the UA stylesheet.
    //
    
    input {
      line-height: normal;
    }
    
    //
    // It's recommended that you don't attempt to style these elements.
    // Firefox's implementation doesn't respect box-sizing, padding, or width.
    //
    // 1. Address box sizing set to `content-box` in IE 8/9/10.
    // 2. Remove excess padding in IE 8/9/10.
    //
    
    input[type="checkbox"],
    input[type="radio"] {
      box-sizing: border-box; // 1
      padding: 0; // 2
    }
    
    //
    // Fix the cursor style for Chrome's increment/decrement buttons. For certain
    // `font-size` values of the `input`, it causes the cursor style of the
    // decrement button to change from `default` to `text`.
    //
    
    input[type="number"]::-webkit-inner-spin-button,
    input[type="number"]::-webkit-outer-spin-button {
      height: auto;
    }
    
    //
    // Remove default vertical scrollbar in IE 8/9/10/11.
    //
    
    textarea {
      overflow: auto;
    }
/*--------------------------------------*/

// this is complement of the dark theme

@function compl($color) {
    @return rgb(255 - red($color), 255 - green($color), 255 - blue($color));
}

$default-background:         compl(#111318);
$font-color:                 compl(#ccd4e0);
$hover-font-color:           compl(#51A2FB);
$entity-current-font-color:  compl(#68BEFD);
$msp-btn-commit-on-font-color:   compl(#68BEFD);
$entity-badge-font-color:    lighten(#ccd4e0,10%);
$msp-btn-remove-background:      #DE0A28;
$msp-btn-remove-hover-font-color:#F2F4F7;

// used in LOG
$log-message:          #0CCA5D;
$log-info:             #5E3673;
$log-warning:          #FCC937;
$log-error:            #FD354B;

$logo-background: compl(#111318);

@function color-lower-contrast($color, $amount) {
    @return lighten($color, $amount);
}

@function color-increase-contrast($color, $amount) {
    @return darken($color, $amount);
}

// measures

$control-label-width:   110px;
$control-label-short-width:   70px;
$row-height:            32px;
$control-spacing:       10px;
$entity-subtree-offset: 8px;
$info-vertical-padding: 3px;
$slider-border-radius-base: 6px;

// layout
$expanded-top-height:    100px;
$expanded-bottom-height: 70px; // 3 * $row-height + 2;
$expanded-right-width:   300px;
$expanded-left-width:    330px;

$collapsed-left-width:   $row-height;

$expanded-portrait-bottom-height: 10 * ($row-height + 1) + 3 * $control-spacing + 1;
$expanded-portrait-top-height:    3 * $row-height + 1;

$standard-bottom-height: 8 * ($row-height + 1) + 3 * $control-spacing + 1;
$standard-top-height:    3 * $row-height + 1;


$color-accent-cyan:      color-lower-contrast(#95a5a6, 15%);
$color-accent-red:       color-lower-contrast(#e74c3c, 15%);
$color-accent-gray:      color-lower-contrast(#34495e, 10%);
$color-accent-green:     color-lower-contrast(#2ecc71, 10%);
$color-accent-purple:    color-lower-contrast(#9b59b6, 10%);
$color-accent-blue:      color-lower-contrast(#3498db, 5%);
$color-accent-orange:    color-lower-contrast(#e67e22, 5%);

// TypeClass = 'Root' | 'Group' | 'Data' | 'Object' | 'Representation3D' | 'Behavior'

$type-class-Root:             $default-background;
$type-class-Data:             color-lower-contrast(#95a5a6, 15%);
$type-class-Object:           color-lower-contrast(#2ecc71, 10%);
$type-class-Behavior:         color-lower-contrast(#9b59b6, 10%);
$type-class-Representation3D: color-lower-contrast(#3498db, 5%);
$type-class-Group:            color-lower-contrast(#e67e22, 5%);

//////////////////////////////////////////////////
// COLORS and COMPUTED COLORS

$slider-disabledColor: #ccc;

$control-background: color-increase-contrast($default-background, 6.5%);
$border-color: color-increase-contrast($default-background, 15%);
$msp-form-control-background: color-lower-contrast($default-background, 2.5%);

// buttons
$msp-btn-link-font-color: $font-color;
$msp-btn-link-toggle-on-font-color: $font-color;
$msp-btn-link-toggle-off-font-color: color-lower-contrast($font-color, 33%);

// used for "actions" -- i.e. + in selection
$msp-btn-remove-font-color: $font-color;

$msp-btn-action-background: $msp-form-control-background;

// update selection etc
//!! $msp-btn-commit-on-font-color: $entity-current-font-color;
$msp-btn-commit-on-hover-font-color: color-lower-contrast($msp-btn-commit-on-font-color, 20%); //!!Change
$msp-btn-commit-on-background: color-lower-contrast($default-background, 2%);
$msp-btn-commit-off-background:  color-lower-contrast($default-background, 4%); //$control-background;
$msp-btn-commit-off-font-color: $font-color;

// log
$log-font-color: color-lower-contrast($font-color, 5%);
$log-timestamp-font-color: color-lower-contrast($font-color, 20%);

// highlight
$highlight-info-font-color: $hover-font-color;
$highlight-info-additional-font-color: color-lower-contrast($hover-font-color, 20%);

// entity state
$entity-color-fully-visible: $font-color;
$entity-color-not-visible: color-lower-contrast($font-color, 66%);
$entity-color-partialy-visible: color-lower-contrast($font-color, 33%);
$entity-tag-color: color-lower-contrast($font-color, 20%);

// sequence
$sequence-background: $default-background;
$sequence-number-color: $hover-font-color;

// state
$state-image-height: 96px;


.msp-sequence {
    position: relative;
    right: 0;
    top: 0;
    left: 0;
    bottom: 0;
    background: #f3f2ee;
    height: 100%;
    padding-bottom: 22px;
}

.msp-sequence * {
    font-family: "Courier New", monospace !important;
    font-size: 9pt !important;
}

$sequence-select-height: 24px;
.msp-sequence-select {
    position: relative;
    height: $sequence-select-height;
    width: 100%;
    margin-bottom: 1px;
    background: $control-background;
    text-align: left;

    > span {
        display: inline-block;
        line-height: $sequence-select-height;
        padding: 0 $control-spacing;
        font-size: 85%;
        font-weight: bold;
        cursor: default;
    }

    > select {
        display: inline-block;
        max-width: 120px;
        width: auto;
        text-overflow: ellipsis;
        font-size: 85%;
        height: $sequence-select-height;
        line-height: $sequence-select-height;
        background-size: 6px 8px;
        background-color: $control-background;
    }
}

.msp-sequence-wrapper {
    word-break: break-word;
    // use $control-spacing for top to have space for sequence numebrs
    padding: $control-spacing $control-spacing $info-vertical-padding $control-spacing;
    user-select: none;
}

.msp-sequence-wrapper-non-empty {
    font-size: 85%;
    line-height: 215%;
    background: #f3f2ee;
    width: 100%;
    overflow-y: scroll !important;
    /* overflow-x: hidden; */
    position: relative !important;
    /* top: 0; */
    /* left: 0; */
    /* bottom: 0; */
    /* right: 0; */
    height: 100% !important;
  }

.msp-sequence-chain-label {
    margin-left: $control-spacing;
    margin-top: $control-spacing;
    user-select: none;
    color: $sequence-number-color;
    font-size: 90%;
    line-height: 90%;
    padding-left: 0.2em;
}

.msp-sequence-wrapper {
    span {
        cursor: pointer;
    }

    .msp-sequence-residue-long {
        margin: 0em 0.2em 0em 0.2em;
    }

    .msp-sequence-residue-long-begin {
        margin: 0em 0.2em 0em 0em;
    }

    .msp-sequence-label {
        color: $sequence-number-color;
        font-size: 90%;
        line-height: 90%;
        padding-bottom: 1em;
        padding-left: 0.2em;
    }
    
    .msp-sequence-number {
        color: $sequence-number-color;
        word-break: keep-all;
        cursor: default;
        position: relative;
        top: -1.1em;
        left: 3.1em;
        padding: 0px;
        margin-left: -3em;
        font-size: 80%;
    }

    .msp-sequence-number-long {
        left: 3.3em;
    }

    .msp-sequence-number-long-negative {
        left: 2.7em;
    }

    .msp-sequence-number-negative {
        left: 2.5em;
    }

    .msp-sequence-present {
        color: $font-color;
    }

    .msp-sequence-missing {
        color: color-lower-contrast($font-color, 33%);
    }
}



.msp-form-control {
    display: block;
    width: 100%;
    background: $msp-form-control-background;
    // color: $font-color;
    border: none; // !important;
    padding: 0 $control-spacing;
    line-height: $row-height - 2px;
    height: $row-height;
    -webkit-appearance: none;
    -moz-appearance: none;
    appearance: none;
    -webkit-box-shadow: none; // iOS <4.3 & Android <4.1
    box-shadow: none;
    // box-shadow: none !important;
    background-image: none;

    // Firefox
    &::-moz-placeholder {
        color: color-lower-contrast($font-color, 33%);
        opacity: 1; // Override Firefox's unusual default opacity; see https://github.com/twbs/bootstrap/pull/11526
    }
    &:-ms-input-placeholder { color: color-lower-contrast($font-color, 33%); } // Internet Explorer 10+
    &::-webkit-input-placeholder  { color: color-lower-contrast($font-color, 33%); } // Safari and Chrome

    &:hover {
        color: $hover-font-color;
        background-color: color-increase-contrast($msp-form-control-background, 5%);
        border: none;
        outline-offset: -1px !important;
        outline: 1px solid color-increase-contrast($msp-form-control-background, 20%) !important;
    }

    &:active, &:focus {
        color: $font-color;
        background-color: $msp-form-control-background;
        border: none;
        outline-offset: 0;
        outline: none;
    }

    // Disabled and read-only inputs
    //
    // HTML5 says that controls under a fieldset > legend:first-child won't be
    // disabled if the fieldset is disabled. Due to implementation difficulty, we
    // don't honor that edge case; we style them as disabled anyway.
    &[disabled],
    &[readonly],
    fieldset[disabled] & {
        background: $default-background;
        opacity: 0.35;
    }
}

.msp-btn {
    @extend .msp-form-control;

    display: inline-block;
    margin-bottom: 0; // For input.msp-btn
    text-align: center;
    touch-action: manipulation;
    cursor: pointer;
    background-image: none; // Reset unusual Firefox-on-Android default style; see https://github.com/necolas/normalize.css/issues/214
    white-space: nowrap;
    @include user-select(none);


    padding: 0 $control-spacing;
    line-height: $row-height;
    border: none;
    -moz-box-sizing: border-box;
    box-sizing: border-box;

    &[disabled] {
        background: $default-background;
        opacity: 0.35;
    }
}

.msp-btn-block {
    display: block;
    width: 100%;
}

.msp-btn, .msp-btn:active, .msp-btn-link:focus, .msp-btn:hover {
    outline: none;
}

.msp-material-icon {
    svg {
        display: inline-flex;
        vertical-align: middle;
        font-size: 1.2em;
        margin-bottom: 3px;

        fill: currentColor;
        width: 1em;
        height: 1em;
        flex-shrink: 0;
        user-select: none;
    }
}

.msp-btn-block {
    > .msp-material-icon {
        margin-left: 0;
        margin-right: .4em;
    }
}

.msp-btn-childless {
    > .msp-material-icon {
        margin-left: 0;
        margin-right: 0;
    }
}

.msp-btn-icon {
    border: none;
    height: $row-height;
    width: $row-height;
    line-height: $row-height;
    padding: 0;
    text-align: center;

    &:hover {
        color: $hover-font-color;
        background-color: color-increase-contrast($msp-form-control-background, 5%);
        border: none;
        outline-offset: -1px !important;
        outline: 1px solid color-increase-contrast($msp-form-control-background, 20%) !important;
    }

    &[disabled], &[disabled]:hover, &[disabled]:active {
        color: $msp-btn-link-toggle-off-font-color;
    }
}

.msp-btn-icon-small {
    border: none;
    height: $row-height;
    width: 20px;
    // font-size: 85%;
    line-height: $row-height;
    padding: 0;
    text-align: center;

    &:hover {
        color: $hover-font-color;
        background-color: color-increase-contrast($msp-form-control-background, 5%);
        border: none;
        outline-offset: -1px !important;
        outline: 1px solid color-increase-contrast($msp-form-control-background, 20%) !important;
    }

    &[disabled], &[disabled]:hover, &[disabled]:active {
        color: $msp-btn-link-toggle-off-font-color;
    }
}

.msp-btn-link {
    font-weight: normal;
    border-radius: 0;

    &,
    &:active,
    &.active,
    &[disabled],
    fieldset[disabled] & {
        background-color: transparent;
        -webkit-box-shadow: none; // iOS <4.3 & Android <4.1
        box-shadow: none;
    }
    &,
    &:hover,
    &:focus,
    &:active {
        border-color: transparent;
    }
    &:hover,
    &:focus {
        text-decoration: none;
        background-color: transparent;
    }
    &[disabled],
    fieldset[disabled] & {
        &:hover,
        &:focus {
        text-decoration: none;
        }
    }

    .msp-icon {
        font-size: 100%;
    }
}

.msp-btn-link, .msp-btn-link:active, .msp-btn-link:focus {
    color: $msp-btn-link-font-color;
    text-decoration: none;
}

.msp-btn-link:hover {
    color: $hover-font-color;
    text-decoration: none;
}

.msp-btn-link-toggle-on {
    color: $msp-btn-link-toggle-on-font-color;
}

.msp-btn-link-toggle-off, .msp-btn-link-toggle-off:active, .msp-btn-link-toggle-off:focus {
    color: $msp-btn-link-toggle-off-font-color !important;
}

.msp-btn-link-toggle-off:hover,  .msp-btn-link-toggle-on:hover {
    color: $hover-font-color !important;
}

@mixin msp-btn($name, $font, $bg) {
    .msp-btn-#{$name}, .msp-btn-#{$name}:active, .msp-btn-#{$name}:focus {
        color: $font;
        background: $bg;
    }
    .msp-btn-#{$name}:hover {
        color: $hover-font-color;
        background: color-lower-contrast($bg, 2.5%);
    }

    .msp-btn-#{$name}[disabled], .msp-btn-#{$name}[disabled]:hover,
    .msp-btn-#{$name}[disabled]:active, .msp-btn-#{$name}[disabled]:focus {
        color: color-lower-contrast($font, 1%);
    }
}

// @include msp-btn('remove', $msp-btn-remove-font-color, $msp-btn-remove-background);
@include msp-btn('action', $font-color, $msp-btn-action-background);
@include msp-btn('commit-on', $msp-btn-commit-on-font-color, $msp-btn-commit-on-background);
@include msp-btn('commit-off', $msp-btn-commit-off-font-color, $msp-btn-commit-off-background);

.msp-btn-remove:hover {
    color: $msp-btn-remove-hover-font-color;
}
.msp-btn-commit-on:hover {
	color: $msp-btn-commit-on-hover-font-color;
}

.msp-btn-action {
    height: $row-height;
    line-height: $row-height;
}

input[type="file"] {
    display: block;
}

// Make range inputs behave like textual form controls
input[type="range"] {
    display: block;
    width: 100%;
}

// Make multiple select elements height not fixed
select[multiple],
select[size] {
    height: auto;
}

// Reset height for `textarea`s
textarea.msp-form-control {
    height: auto;
}

.msp-control-top-offset {
    margin-top: 1px;
}

.msp-btn-commit {
    text-align: right;
    padding-top: 0;
    padding-bottom: 0;
    padding-right: $control-spacing;
    padding-left: 0;
    line-height: $row-height;
    border: none;
    overflow: hidden;
    font-weight: bold;

    .msp-icon {
        display: block-inline;
        line-height: $row-height;
        width: $row-height;
        text-align: center;
    }
}

select.msp-form-control {
    background: none;
    background-color: $msp-form-control-background;
    background-size: 8px 12px;
    background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAUCAMAAACzvE1FAAAADFBMVEUzMzMzMzMzMzMzMzMKAG/3AAAAA3RSTlMAf4C/aSLHAAAAPElEQVR42q3NMQ4AIAgEQTn//2cLdRKppSGzBYwzVXvznNWs8C58CiussPJj8h6NwgorrKRdTvuV9v16Afn0AYFOB7aYAAAAAElFTkSuQmCC);
    background-repeat: no-repeat;
    background-position: right $control-spacing center;
    padding-right: ($row-height - 8px);
}

select.msp-form-control:-moz-focusring {
    color: transparent;
    text-shadow: 0 0 0 $font-color;
}

.msp-default-bg {
    background: $default-background;
}

.msp-transparent-bg {
    background: transparent;
}

.msp-no-hover-outline {
    &:hover {
        color: $hover-font-color;
        background-color: inherit;
        border: none;
        outline-offset: 0 !important;
        outline: none !important;
    }
}

.msp-icon-inline {
    margin-right: 8px;
}

.msp-control-row {
    position: relative;
    height: $row-height;
    background: $default-background;
    margin-top: 1px;

    select, button, input[type=text] {
        @extend .msp-form-control;
    }

    button {
        @extend .msp-btn;
        @extend .msp-btn-block;
    }

    > span.msp-control-row-label, > button.msp-control-button-label {
        line-height: $row-height;
        display: block;
        width: $control-label-width + $control-spacing;
        text-align: right;
        padding: 0 $control-spacing;
        color: color-lower-contrast($font-color, 15%);
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
        position: relative;

        @include non-selectable;
    }

    > button.msp-control-button-label {
        background: $default-background;
        cursor: pointer;
    }

    .msp-control-current {
        background: $default-background;
    }

    > div.msp-control-row-ctrl {
        position: absolute;
        left: $control-label-width + $control-spacing;
        top: 0;
        right: 0;
        bottom: 0;
    }

    > div {
        background: $msp-form-control-background;
    }

    > .msp-flex-row {
        background: $default-background;
    }
}

.msp-control-label-short {
    > span {
        width: $control-label-short-width + $control-spacing !important;
    }

    > div:nth-child(2) {
        left: $control-label-short-width + $control-spacing !important;
    }
}

.msp-control-col-2 {
    float: left;
    width: 50%;
}

.msp-control-twoline {
    height: 2 * $row-height !important;
}

.msp-control-group {
    position: relative;
}

.msp-toggle-button {
    .msp-icon {
        display: inline-block;
        margin-right: 6px;
    }

    > div > button:hover {
        border-color: color-increase-contrast($msp-form-control-background, 5%) !important;
        border: none;
        outline-offset: -1px  !important;
        outline: 1px solid color-increase-contrast($msp-form-control-background, 20%) !important;
    }
}

// .msp-slider {
//     > div:first-child {
//         position: absolute;
//         top: 0;
//         left: 18px;
//         bottom: 0;
//         right: 62px;
//         display: flex;
//     }
//     > div:last-child {
//         position: absolute;
//         height: $row-height;
//         line-height: $row-height;
//         text-align: center;
//         right: 0;
//         width: 50px;
//         top: 0;
//         bottom: 0;
//     }

//     input[type=text] {
//         padding-right: 6px;
//         padding-left: 4px;
//         font-size: 80%;
//         text-align: right;
//     }

//     // input[type=range] {
//     //     width: 100%;
//     // }
// }

// .msp-slider2 {
//     > div:first-child {
//         position: absolute;
//         height: $row-height;
//         line-height: $row-height;
//         text-align: center;
//         left: 0;
//         width: 25px;
//         top: 0;
//         bottom: 0;
//         font-size: 80%;
//     }
//     > div:nth-child(2) {
//         position: absolute;
//         top: 0;
//         left: 35px;
//         bottom: 0;
//         right: 37px;
//         display: flex;
//     }
//     > div:last-child {
//         position: absolute;
//         height: $row-height;
//         line-height: $row-height;
//         text-align: center;
//         right: 0;
//         width: 25px;
//         top: 0;
//         bottom: 0;
//         font-size: 80%;
//     }

//     input[type=text] {
//         padding-right: 4px;
//         padding-left: 4px;
//         font-size: 80%;
//         text-align: center;
//     }

//     // input[type=range] {
//     //     width: 100%;
//     // }
// }

.msp-toggle-color-picker {
    button {
        border: $control-spacing solid $msp-form-control-background !important;
        margin: 0;
        text-align: center;
        padding-right: $control-spacing;
        padding-left: $control-spacing;

        &:hover {
            border-color: color-increase-contrast($msp-form-control-background, 5%) !important;
            border: none;
            outline-offset: -1px  !important;
            outline: 1px solid color-increase-contrast($msp-form-control-background, 20%) !important;
        }
    }

    .msp-color-picker {
        position: absolute;
        z-index: 100000;
        background: $default-background;
        border-top: 1px solid $default-background;
        padding-bottom: math.div($control-spacing, 2);
        width: 100%;

        // input[type=text] {
        //     background: $msp-form-control-background !important;
        // }
    }
}

.msp-toggle-color-picker-above {
    .msp-color-picker {
        top: -2 * 32px - 16px - math.div($control-spacing, 2);
        height: 2 * 32px + 16px + math.div($control-spacing, 2);
    }
}

.msp-toggle-color-picker-below {
    .msp-color-picker {
        top: $row-height;
        height: 2 * 32px + 16px;
    }
}

.msp-control-offset {
    padding-left: $control-spacing;
}

.msp-accent-offset {
    padding-left: 1px;
    margin-left: $control-spacing - 2;
    border-left: 2px solid $color-accent-orange;
}

// .msp-accent-offset-right {
//     margin-left: $control-spacing;
//     padding-right: 1px;
//     border-right: 2px solid $color-accent-orange;
// }

.msp-control-group-wrapper {
    //border-left-width: math.div($control-spacing, 2);
    //border-left-style: solid;
    //border-left-color: color-increase-contrast($default-background, 10%);

    margin-bottom: 0px;
    margin-top: 1px;
}

// TODO : get rid of the important
.msp-control-group-header {
    background: $default-background;
    > button, div {
        padding-left: 4px; // math.div($control-spacing, 2) !important;
        text-align: left;
        height: 32px !important;
        line-height: 32px !important;
        font-size: 85% !important;
        background: $default-background !important;
        color: color-lower-contrast($font-color, 15%);
    }
    .msp-icon {
        height: 24px !important;
        line-height: 24px !important;
    }
    > span {
        padding-left: math.div($control-spacing, 2);
        line-height: math.div(2 * $row-height, 3);
        font-size: 70%;
        background: $default-background;
        color: color-lower-contrast($font-color, 15%);
    }
}

.msp-control-current {
    background: $default-background;
}

.msp-control-group-footer {
    background: color-increase-contrast($default-background, 5%);
    height: math.div($control-spacing, 2);
    font-size: 1px;
    margin-top: 1px;
}

.msp-control-group-expander {
    display: block;
    position: absolute;
    line-height: $row-height;
    padding: 0;
    left: 0;
    top: 0;
    width: $control-label-width + $control-spacing;
    text-align: left;
    background: transparent;

    .msp-icon {
        line-height: $row-height - 3;
        width: $row-height - 1;
        text-align: center;
        // display: inline-block;
        font-size: 100%;
    }
}

.msp-plugin-layout_controls {
    position: absolute;
    left: $control-spacing;
    top: $control-spacing;
}

.msp-plugin-layout_controls > button:first-child {
    margin-right: 6px;
}

.msp-empty-control {
    display: none;
}

.msp-control .msp-btn-block {
    margin-bottom: 0px;
    margin-top: 0px;
}

.msp-row-text {
    height: $row-height;
    position: relative;
    background: $default-background;
    margin-top: 1px;

    > div {
        line-height: $row-height;
        text-align: center;
        color: color-lower-contrast($font-color, 15%);
    }
}

.msp-help span {
    display: none;
}

.msp-help:hover span {
    display: inline-block;
    background: linear-gradient($default-background, change-color($default-background, $alpha: 0.8));
}

.msp-help-text {
    position: relative;
    background: $default-background;
    margin-top: 1px;

    > div {
        padding: (math.div($control-spacing, 2)) $control-spacing;
        text-align: left;
        color: color-lower-contrast($font-color, 15%);
    }
}

.msp-help-description {
    font-style: italic;
}

.msp-help-legend {
    padding-top: $control-spacing;
}

.msp-scale-legend {
    > div {
        width: 100%;
        height: $control-spacing * 3;

        > span {
            padding: math.div($control-spacing, 2);
            color: white;
            font-weight: bold;
            background-color: rgba(0, 0, 0, 0.2);
        }
    }
}

.msp-table-legend {
    > div {
        // min-width: 60px;
        margin-right: math.div($control-spacing, 2);
        display: inline-flex;

        .msp-table-legend-color {
            width: $control-spacing * 3;
            height: $control-spacing * 2;
        }

        .msp-table-legend-text {
            margin: 0 (math.div($control-spacing, 2));
        }
    }
}

.msp-image-preview {
    position: relative;
    background: $default-background;
    margin-top: 1px;
    padding: $control-spacing;

    canvas {
        @include user-select(none);
    }

    > span {
        margin-top: 6px;
        display: block;
        text-align: center;
        font-size: 80%;
        line-height: 15px;
    }
}

.msp-copy-image-wrapper {
    position: relative;

    div {
        font-weight: bold;
        padding: 3px;
        margin: 1px 0;
        width: 100%;
        background: $msp-form-control-background;
        text-align: center;
    }

    img {
        margin-top: 1px;
    }
}

.msp-control-text-area-wrapper, .msp-text-area-wrapper {
    position: relative;
    textarea {
        border: none;
        width: 100%;
        height: 100%;
        background: $msp-form-control-background;
        padding: math.div($control-spacing, 2) $control-spacing;
        resize: none;
        font-size: 12px;
        line-height: 16px;
    }
}

.msp-control-text-area-wrapper {
    height: 2 * $row-height !important;
}

.msp-text-area-wrapper {
    height: 3 * $row-height !important;
}



.msp-help-row {    
    position: relative;
    height: $row-height;
    background: $default-background;
    margin-top: 1px;
    display: table;
    width: 100%;
    
    > span {
        width: $control-label-width + $control-spacing;
        text-align: right;
        padding: $info-vertical-padding $control-spacing; 
        color: color-lower-contrast($font-color, 15%);
        display: table-cell;
        font-weight: bold;
        
        @include non-selectable;        
    }
        
    > div {
        background: $msp-form-control-background;
        position: relative;
        padding: $info-vertical-padding $control-spacing;
        display: table-cell;
    }
}


.msp-description {
    padding: $control-spacing;
    font-size: 85%;
    background: $default-background;
    text-align: center;
    //font-style: italic;

    -webkit-user-select: none; /* Chrome/Safari */
    -moz-user-select: none; /* Firefox */
    -ms-user-select: none; /* IE10+ */

    /* Rules below not implemented in browsers yet */
    -o-user-select: none;
    user-select: none;

    font-weight: light;

    cursor: default;
}

.msp-description:not(:first-child) {
    border-top: 1px solid $control-background;
}

.msp-color-picker input {
    color: black !important;
}

.msp-no-webgl {
    position: absolute;
    width: 100%;
    height: 100%;
    left: 0;
    top: 0;
    display: table;
    text-align: center;
    background: $default-background;

    > div {
        b {
            font-size: 120%;
        }
        display: table-cell;
        vertical-align: middle;
        text-align: center;
        width: 100%;
        height: 100%;
    }
}

.msp-loader-msp-btn-file {
    position: relative;
    overflow: hidden;
}

.msp-loader-msp-btn-file input[type=file] {
    position: absolute;
    top: 0;
    right: 0;
    min-width: 100%;
    min-height: 100%;
    font-size: 100px;
    text-align: right;
    filter: alpha(opacity=0);
    opacity: 0;
    outline: none;
    background: white;
    cursor: inherit;
    display: block;
}

.msp-controls-section {
    margin-bottom: $control-spacing;
}

.msp-combined-color-button {
    border: 4px solid $msp-form-control-background !important;
    margin: 0;
    text-align: center;
    padding-right: $control-spacing;
    padding-left: $control-spacing;

    &:hover {
        border-color: color-increase-contrast($msp-form-control-background, 5%) !important;
        border: none;
        outline-offset: -1px  !important;
        outline: 1px solid color-increase-contrast($msp-form-control-background, 20%) !important;
    }
}

.msp-combined-color-swatch {
    width: 100%;
    display: grid;
    grid-gap: 1px;
    grid-template-columns: repeat(6, auto);

    .msp-btn {
        &:hover {
            outline-offset: -1px  !important;
            outline: 1px solid color-increase-contrast($msp-form-control-background, 20%) !important;
        }
    }
}

.msp-action-select {
    position: relative;

    select {
        padding-left: $control-spacing + $row-height;
    }

    option:first-child {
        color: color-lower-contrast($font-color, 15%);
    }

    > .msp-icon {
        display: block;
        top: 0;
        left: $control-spacing;
        position: absolute;
        line-height: $row-height;
    }
}

.msp-simple-help-section {
    height: 28px;
    line-height: 28px;
    margin-top: 5px;
    margin-bottom: 5px;
    padding: 0 10px;
    font-weight: 500;
    background: $default-background;
    color: $font-color;
}

.msp-left-panel-controls-buttons {
    position: absolute;
    width: $row-height;
    top: 0;
    bottom: 0;
    padding-top: $control-spacing;

    background: $default-background;

    // .msp-btn-link-toggle-on {
    //     border-left: 1px solid $font-color;
    // }
}

.msp-left-panel-controls-buttons-bottom {
    position: absolute;
    bottom: 0;
}

.msp-left-panel-controls-button-data-dirty {
    position: absolute;
    width: 6px;
    height: 6px;
    background: $color-accent-orange;
    border-radius: 3px;
    right: 6px;
    bottom: 6px;
}

.msp-left-panel-controls {
    .msp-scrollable-container {
        left: $row-height + 1px;
    }
}

.msp-mapped-parameter-group {
    position: relative;

    > .msp-control-row:first-child {
        > div:nth-child(2) {
            right: 33px;
        }
    }

    > button:first-child {
        right: 33px;
    }

    > .msp-btn-icon {
        position: absolute;
        right: 0;
        width: 32px;
        top: 0;
        padding: 0;
    }
}

.msp-shape-filled {
    fill: $font-color;
    stroke: $font-color;
}

.msp-shape-empty {
    fill: none;
    stroke: $font-color;
}

.msp-no-overflow {
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

.msp-25-lower-contrast-text {
    color: color-lower-contrast($font-color, 25%);
}

.msp-expandable-group-color-stripe {
    position: absolute;
    left: 0;
    top: $row-height - 2px;
    width: $control-label-width + $control-spacing;
    height: 2px;
}

.msp-section-header {
    height: $row-height;
    line-height: $row-height;
    margin-top: $control-spacing;
    margin-bottom: $control-spacing;
    text-align: right;
    padding: 0 $control-spacing;
    font-weight: bold;
    background: $default-background;
    overflow: hidden;
    // border-bottom: 1px solid $color-accent-orange;
    cursor: default;

    > .msp-icon {
        display: block;
        float: left;
    }

    > small {
        font-weight: normal;
    }
}

.msp-current-header {
    height: $row-height;
    line-height: $row-height;
    margin-bottom: $control-spacing;
    text-align: center;
    font-weight: bold;
    background: $default-background;
}

.msp-flex-row {
    margin-top: 1px;
    background: $default-background;

    display:flex;
    flex-direction:row;
    width: inherit;
    height: $row-height;

    > .msp-flex-item {
        margin: 0;
        flex: 1 1 auto;
        margin-right: 1px;
        overflow: hidden;
    }

    > .msp-flex-item:last-child {
        margin-right: 0;
    }

    > select, > button {
        margin: 0;
        flex: 1 1 auto;
        margin-right: 1px;
        height: $row-height;

        // text-align-last: center;
        // padding: 0 $control-spacing;
        overflow: hidden;
    }

    .msp-btn-icon, .msp-btn-icon-small {
        flex: 0 0 32px;
        max-width: 32px;
    }

    > select {
        background: none;

        > option[value = _] {
            display: none;
        }
    }

    > select:last-child, > button:last-child {
        margin-right: 0;
    }

    > button.msp-control-button-label {
        background: $default-background;
    }
}

.msp-state-list {
    list-style: none;
    // margin-top: $control-spacing;

    > li {
        position: relative;
        overflow: hidden;

        > button:first-child {
            text-align: left;
            border-left: $control-spacing solid color-increase-contrast($default-background, 12%) !important;
        }

        > div {
            position: absolute;
            right: 0;
            top: 0;
        }
    }
}

.msp-state-image-row {
    @extend .msp-flex-row;

    height: $state-image-height;
    margin-top: 0px;

    > button {
        height: $state-image-height;
        padding: 0px;

        > img {
            min-height: $state-image-height;
            width: inherit;
            transform: translateY(-50%);
            top: 50%;
            position: relative;
        }
    }
}

.msp-tree-row {
    position: relative;
    margin-top: 0;
    margin-bottom: 1px;
    background: transparent;

    &-current {
        .msp-btn-tree-label {
            > span {
                font-weight: bold;
            }

            border-radius: 0 !important;
        }
    }

    .msp-btn-tree-label {
        text-align: left;
        border-radius: 0 0 0 8px;
        border-left-width: 4px;
        border-left-style: solid;
    }

    .msp-btn-tree-label > small {
        color: color-lower-contrast($font-color, 20%);
    }
}

.msp-tree-updates-wrapper {
    .msp-control-group-header:last-child {
        margin-bottom: 1px;
    }
}

.msp-viewport-top-left-controls {
    position: absolute;
    right: 0 !important;
    top: 260px !important;
    left: auto !important;

    .msp-traj-controls {
        line-height: $row-height;
        float: left;
        margin-right: $control-spacing;
        background-color: $msp-form-control-background;

        > span {
            color: $font-color;
            margin-left: $control-spacing;
            margin-right: $control-spacing;
            font-size: 85%;
            display: inline-block;
        }
    }

    .msp-state-snapshot-viewport-controls {
        line-height: $row-height;
        float: left;
        margin-right: $control-spacing;

        > button {
            background-color: $msp-form-control-background;
        }

        > select {
            display: inline-block;
            width: 200px;
            margin-right: $control-spacing;
        }
    }

    .msp-animation-viewport-controls {
        line-height: $row-height;
        float: left;
        margin-right: $control-spacing;
        position: relative;

        > div:first-child {
            position: relative;
            display: inline-block;

            > button {
                position: relative;
            }
        }

        .msp-animation-viewport-controls-select {
            width: 290px;
            position: absolute;
            right: 0 !important;
            left: auto !important;
            margin-top: $control-spacing;
            background: $control-background;

            .msp-control-row:first-child {
                margin-top: 0;
            }
        }
    }
}

.msp-selection-viewport-controls {
    position: relative;
    // display: inline-block;
    margin: $control-spacing auto 0 auto;
    width: 430px;

    &-actions {
        position: absolute;
        width: 100%;
        top: $row-height;
        background: $control-background;
    }

    > .msp-flex-row .msp-btn {
        padding: 0 5px;
    }

    select.msp-form-control {
        padding: 0 5px;
        text-align: center;
        background: $msp-form-control-background;
        flex: 0 0 80px;
        text-overflow: ellipsis;
    }
}

.msp-param-object-list-item {
    margin-top: 1px;
    position: relative;
    > button {
        text-align: left;
        > span {
            font-weight: bold;
        }
    }
    > div {
        position: absolute;
        right: 0;
        top: 0
    }
}

.msp-state-actions {
    .msp-transform-wrapper:last-child {
        margin-bottom: 10px;
    }
}

.msp-button-row {
    display:flex;
    flex-direction:row;
    height: $row-height;
    width: inherit;

    > button {
        margin: 0;
        flex: 1 1 auto;
        margin-right: 1px;
        height: $row-height;

        text-align-last: center;
        background: none;
        padding: 0 $control-spacing;
        overflow: hidden;
    }
}

.msp-action-menu-options {
    &-no-header, .msp-control-group-children {
        max-height: 300px;
        overflow: hidden;
        overflow-y: auto;
    }

    .msp-control-row, button, .msp-icon, .msp-flex-row {
        height: 24px;
        line-height: 24px;
    }

    button {
        text-align: left;
    }


    .msp-action-menu-button {
        margin-top: 1px;
        display: flex;
        .msp-icon {
            margin-right: 6px;
        }
    }
}

.msp-representation-entry {
    position: relative;
    > .msp-control-group-header {
        > .msp-btn {
            font-weight: bold;
        }
        > .msp-icon, > .msp-btn-link {
            line-height: 24px;
            height: 24px;
        }
    }
}

.msp-control-group-presets-wrapper {
    position: absolute;
    right: 0;
    top: 0;
    .msp-control-group-header {
        background: transparent;
    }
    button {
        background: transparent !important;
    }
}

.msp-parameter-matrix {
    input {
        flex: 1 1 auto;
        min-width: 0;
    }
}

.msp-btn-apply-simple {
    text-align: left;
    .msp-icon {
        margin-right: 10px;
    }
}

@mixin type-class-border($name, $color) {
    .msp-type-class-#{$name} {
        border-left-color: $color;
    }
}

// TypeClass = 'Root' | 'Group' | 'Data' | 'Object' | 'Representation3D' | 'Behavior'
@include type-class-border('Root', $type-class-Root);
@include type-class-border('Group', $type-class-Group);
@include type-class-border('Data', $type-class-Data);
@include type-class-border('Object', $type-class-Object);
@include type-class-border('Representation3D', $type-class-Representation3D);
@include type-class-border('Behavior', $type-class-Behavior);

@mixin accent($name, $color) {
    .msp-accent-color-#{$name} {
        color: $color;
    }
    .msp-accent-bg-#{$name} {
        background: $color;
    }
    .msp-transform-header-brand-#{$name} {
        border-bottom: 1px solid $color;
        &:active, &:focus {
            border-bottom: 1px solid $color;
        }
    }
}

@include accent('cyan', $color-accent-cyan);
@include accent('red', $color-accent-red);
@include accent('gray', $color-accent-gray);
@include accent('green', $color-accent-green);
@include accent('purple', $color-accent-purple);
@include accent('blue', $color-accent-blue);
@include accent('orange', $color-accent-orange);

.msp-volume-channel-inline-controls {
    > :first-child {
        position: absolute;
        left: 0;
        top: 0;
        height: $row-height;
        right: 32px;
    }

    .msp-slider {
        > div:first-child {
            right: 42px;
        }
        > div:last-child {
            width: 30px;
        }
    }

    > button {
        position: absolute;
        right: 0;
        width: 32px;
        top: 0;
        padding: 0;

        .msp-material-icon {
            margin-right: 0;
        }
    }
}

.msp-list-unstyled {
    padding-left: 0;
    list-style: none;
}

.msp-drag-drop-overlay {
    border: 12px dashed $font-color;
    background: rgba(0, 0, 0, 0.36);
    display: flex;
    align-items: center;
    justify-content: center;
    position: absolute;
    left: 0;
    right: 0;
    top: 0;
    bottom: 0;
    font-size: 48px;
    font-weight: bold;
}

